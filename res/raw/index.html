<!DOCTYPE html
PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
	<meta charset="utf-8">
	<title>DroidIPC!</title>
	<script src="./proc.js"></script>
</head>

<body style="margin:auto; width:800px; text-align:center;">
	<div style="font:60px/80px 'microsoft yahei';margin-top:30px;">DroidIPC</div>
	<div id="fps" style="height:40px; font:30px/40px 'microsoft yahei'; text-align:left; margin-left:600px;"></div>
	<div id="vidBox" style="margin-top:10px;background:#F0F0F0;text-align:center;box-shadow: 0 0 20px #888;border-radius:20px;">
		<img id="camImg" width="640"></img>
	</div>
</body>

<script type="text/javascript">

var imgNum=0;
var clientId=Math.floor(Math.random()*100000);
var frmCnt=0;
function setImgSrc(num){
	$("camImg").src="./pic"+clientId+"-"+num+".jpg";
}
setImgSrc(imgNum);
$("camImg").onload=function(){
	var vidMargin=($("vidBox").clientWidth-this.clientWidth)/2;
	$("vidBox").style.height=2+this.clientHeight+"px";
	this.style.marginTop="1px";
	
	frmCnt++;
	
	imgNum++;
	setImgSrc(imgNum);
}

$("camImg").onerror=function(){
	imgNum=0;
	setTimeout("setImgSrc(imgNum)", 300);
}

function fpsCal(){
	$("fps").innerHTML="FPS:"+(frmCnt/2).toFixed(1);
	frmCnt=0;
}
setInterval("fpsCal()", 2000);

</script>
</html>